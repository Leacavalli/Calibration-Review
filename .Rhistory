"Prop_Success_Y"   = Prop_Success_Y,
"Prop_Success_A_P" = Prop_Success_A_P,
"Prop_Success_A_X" = Prop_Success_A_X,
"Prop_Success_A_Y" = Prop_Success_A_Y,
"Prop_Success_B_P" = Prop_Success_B_P,
"Prop_Success_B_X" = Prop_Success_B_X,
"Prop_Success_B_Y" = Prop_Success_B_Y,
"chisq1.PX_statistic" = chisq1.PX_statistic,
"chisq1.PX_p.value"   = chisq1.PX_p.value,
"chisq1.PX_Result"    = chisq1.PX_Result,
"chisq1.PY_statistic" = chisq1.PY_statistic,
"chisq1.PY_p.value"   = chisq1.PY_p.value,
"chisq1.PY_Result"    = chisq1.PY_Result,
"chisq1.XY_statistic" = chisq1.XY_statistic,
"chisq1.XY_p.value"   = chisq1.XY_p.value,
"chisq1.XY_Result"    = chisq1.XY_Result,
"chisq2.A.PX_statistic" = chisq2.A.PX_statistic,
"chisq2.A.PX_p.value"   = chisq2.A.PX_p.value,
"chisq2.A.PX_Result"    = chisq2.A.PX_Result,
"chisq2.A.PY_statistic" = chisq2.A.PY_statistic,
"chisq2.A.PY_p.value"   = chisq2.A.PY_p.value,
"chisq2.A.PY_Result"    = chisq2.A.PY_Result,
"chisq2.A.XY_statistic" = chisq2.A.XY_statistic,
"chisq2.A.XY_p.value"   = chisq2.A.XY_p.value,
"chisq2.A.XY_Result"    = chisq2.A.XY_Result,
"chisq2.B.PX_statistic" = chisq2.B.PX_statistic,
"chisq2.B.PX_p.value"   = chisq2.B.PX_p.value,
"chisq2.B.PX_Result"    = chisq2.B.PX_Result,
"chisq2.B.PY_statistic" = chisq2.B.PY_statistic,
"chisq2.B.PY_p.value"   = chisq2.B.PY_p.value,
"chisq2.B.PY_Result"    = chisq2.B.PY_Result,
"chisq2.B.XY_statistic" = chisq2.B.XY_statistic,
"chisq2.B.XY_p.value"   = chisq2.B.XY_p.value,
"chisq2.B.XY_Result"    = chisq2.B.XY_Result
)
}
# Test: run the optimized scenario 1 time
Optimized_scenario_test <- Optimized_scenario_simulation(x=5,
efficacy.bounds = efficacy_and_futility$criticalValues,
futility.bounds = c(0,0,0, efficacy_and_futility$futilityBounds[3:4]),
pAP=0.7, pAX=0.75, pAY=0.75, pBP=0.5, pBX=0.7, pBY=0.9)
# Run the simulation under the Simple scenario several times
Optimized_scenario_df <- data.frame(matrix(ncol = length(Optimized_scenario_test), nrow = 1000))
colnames(Optimized_scenario_df) <- names(Optimized_scenario_test)
seed <- 0
for(i in 1:nrow(Optimized_scenario_df)){
seed <- seed + 1
set.seed(seed)
Optimized_scenario_df[i,] <- Optimized_scenario_simulation(x=5,
efficacy.bounds = efficacy_and_futility$criticalValues,
futility.bounds = c(0,0,0, efficacy_and_futility$futilityBounds[3:4]),
pAP=0.7, pAX=0.75, pAY=0.75, pBP=0.5, pBX=0.7, pBY=0.9)
}
# Output table summarizing the results across 1000 simulations
Optimized_scenario_df
# Test: run the optimized scenario 1 time
Optimized_scenario_No_Effect_test <- Optimized_scenario_simulation(x=5,
efficacy.bounds = efficacy_and_futility$criticalValues,
futility.bounds = c(0,0,0, efficacy_and_futility$futilityBounds[3:4]),
pAP=0.7, pAX=0.7, pAY=0.7, pBP=0.5, pBX=0.5, pBY=0.5)
# Run the simulation under the Simple scenario several times
Optimized_scenario_No_Effect_df <- data.frame(matrix(ncol = length(Optimized_scenario_No_Effect_test), nrow = 1000))
colnames(Optimized_scenario_No_Effect_df) <- names(Optimized_scenario_No_Effect_test)
seed <- 0
for(i in 1:nrow(Optimized_scenario_No_Effect_df)){
seed <- seed + 1
set.seed(seed)
Optimized_scenario_No_Effect_df[i,] <- Optimized_scenario_simulation(x=5,
efficacy.bounds = efficacy_and_futility$criticalValues,
futility.bounds = c(0,0,0, efficacy_and_futility$futilityBounds[3:4]),
pAP=0.7, pAX=0.7, pAY=0.7, pBP=0.5, pBX=0.5, pBY=0.5)
}
# Output table summarizing the results across 1000 simulations
Optimized_scenario_No_Effect_df
# Summarize results
# Strength of method measures
# Average final trial size
Simple_N <- mean(as.numeric(Simple_scenario_df$N))
Optimized_N <- mean(as.numeric(Optimized_scenario_df$N))
# Average final Number of failures
Simple_N_Fail <- mean(as.numeric(Simple_scenario_df$N_Fail))
Optimized_N_Fail <- mean(as.numeric(Optimized_scenario_df$N_Fail))
# output table
data.frame(Simple_scenario= c(Simple_N, Simple_N_Fail),
Optimized_scenario= c(Optimized_N, Optimized_N_Fail))
# Primary analysis results
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_df$chisq1.PX_Result=="Superiority: Drug X")
Optimized_DrugX_sup_Placebo <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_df$chisq1.PX_Result=="Superiority: Placebo")
Optimized_Placebo_sup_DrugX <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Placebo")
# Proportion that deemed Drug X futile compared to Placebo
Simple_DrugX_Futility     <- NA
Optimized_DrugX_Futility  <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Futility")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_df$chisq1.PY_Result=="Superiority: Drug Y")
Optimized_DrugY_sup_Placebo <- 100*mean(Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_df$chisq1.PY_Result=="Superiority: Placebo")
Optimized_Placebo_sup_DrugY <- 100*mean(Optimized_scenario_df$chisq1.PY_Result=="Superiority: Placebo")
# Proportion that deemed Drug X futile compared to Placebo
Simple_DrugY_Futility     <- NA
Optimized_DrugY_Futility  <- 100*mean(Optimized_scenario_df$chisq1.PY_Result=="Futility")
# (Co-primary) Drug X vs Drug Y
# Proportion of trials where both Drug X and Drug Y were significantly better than placebo
mean(as.numeric(Simple_scenario_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_df$chisq1.PX_Result=="Superiority: Drug X"
& as.numeric(Simple_scenario_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_df$chisq1.PY_Result=="Superiority: Drug Y")
mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X" & Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y")
# Proportion of where Drug X significantly better than Drug Y
Simple_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq1.XY_p.value) < 0.05 & Simple_scenario_df$chisq1.XY_Result=="Superiority: Drug X")
Optimized_DrugX_sup_DrugY <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X" &
Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Optimized_scenario_df$chisq1.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq1.XY_Result=="Superiority: Drug X")
# Proportion of where Drug Y significantly better than Drug X
Simple_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq1.XY_p.value) < 0.05 & Simple_scenario_df$chisq1.XY_Result=="Superiority: Drug Y")
Optimized_DrugY_sup_DrugX <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X" &
Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Optimized_scenario_df$chisq1.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq1.XY_Result=="Superiority: Drug Y")
# output table
data.frame(Simple_scenario= c(Simple_DrugX_sup_Placebo,
Simple_Placebo_sup_DrugX,
Simple_DrugX_Futility,
Simple_DrugY_sup_Placebo,
Simple_Placebo_sup_DrugY,
Simple_DrugY_Futility,
Simple_DrugX_sup_DrugY,
Simple_DrugY_sup_DrugX),
Optimized_scenario= c(Optimized_DrugX_sup_Placebo,
Optimized_Placebo_sup_DrugX,
Optimized_DrugX_Futility,
Optimized_DrugY_sup_Placebo,
Optimized_Placebo_sup_DrugY,
Optimized_DrugY_Futility,
Optimized_DrugX_sup_DrugY,
Optimized_DrugY_sup_DrugX))
# Secondary analysis
# Type A
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeA_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.PX_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.PX_Result=="Superiority: Drug X")
Optimized_TypeA_DrugX_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.PX_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.PX_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.PX_Result=="Superiority: Placebo")
Optimized_TypeA_Placebo_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.PX_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.PX_Result=="Superiority: Placebo")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug Y
Simple_TypeA_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.PY_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.PY_Result=="Superiority: Drug Y")
Optimized_TypeA_DrugY_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.PY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.PY_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.PY_Result=="Superiority: Placebo")
Optimized_TypeA_Placebo_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.PY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.PY_Result=="Superiority: Placebo")
# Drug X vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeA_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.XY_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.XY_Result=="Superiority: Drug X")
Optimized_TypeA_DrugX_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.XY_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq2.A.XY_p.value) < 0.05 &
Simple_scenario_df$chisq2.A.XY_Result=="Superiority: Drug Y")
Optimized_TypeA_DrugY_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.A.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.A.XY_Result=="Superiority: Drug Y")
# Type B
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeB_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.PX_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.PX_Result=="Superiority: Drug X")
Optimized_TypeB_DrugX_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.PX_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.PX_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.PX_Result=="Superiority: Placebo")
Optimized_TypeB_Placebo_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.PX_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.PX_Result=="Superiority: Placebo")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug Y
Simple_TypeB_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.PY_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.PY_Result=="Superiority: Drug Y")
Optimized_TypeB_DrugY_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.PY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.PY_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.PY_Result=="Superiority: Placebo")
Optimized_TypeB_Placebo_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.PY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.PY_Result=="Superiority: Placebo")
# Drug X vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeB_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.XY_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.XY_Result=="Superiority: Drug X")
Optimized_TypeB_DrugX_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.XY_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_df$chisq2.B.XY_p.value) < 0.05 &
Simple_scenario_df$chisq2.B.XY_Result=="Superiority: Drug Y")
Optimized_TypeB_DrugY_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_df$chisq2.B.XY_p.value) < 0.05 &
Optimized_scenario_df$chisq2.B.XY_Result=="Superiority: Drug Y")
# output table
data.frame(Simple_scenario= c(Simple_TypeA_DrugX_sup_Placebo,
Simple_TypeA_Placebo_sup_DrugX,
Simple_TypeA_DrugY_sup_Placebo,
Simple_TypeA_Placebo_sup_DrugY,
Simple_TypeA_DrugX_sup_DrugY,
Simple_TypeA_DrugY_sup_DrugX,
Simple_TypeB_DrugX_sup_Placebo,
Simple_TypeB_Placebo_sup_DrugX,
Simple_TypeB_DrugY_sup_Placebo,
Simple_TypeB_Placebo_sup_DrugY,
Simple_TypeB_DrugX_sup_DrugY,
Simple_TypeB_DrugY_sup_DrugX),
Optimized_scenario= c(Optimized_TypeA_DrugX_sup_Placebo,
Optimized_TypeA_Placebo_sup_DrugX,
Optimized_TypeA_DrugY_sup_Placebo,
Optimized_TypeA_Placebo_sup_DrugY,
Optimized_TypeA_DrugX_sup_DrugY,
Optimized_TypeA_DrugY_sup_DrugX,
Optimized_TypeB_DrugX_sup_Placebo,
Optimized_TypeB_Placebo_sup_DrugX,
Optimized_TypeB_DrugY_sup_Placebo,
Optimized_TypeB_Placebo_sup_DrugY,
Optimized_TypeB_DrugX_sup_DrugY,
Optimized_TypeB_DrugY_sup_DrugX))
# Summarize results
# Strength of method measures
# Average final trial size
Simple_N <- mean(as.numeric(Simple_scenario_No_Effect_df$N))
Optimized_N <- mean(as.numeric(Optimized_scenario_No_Effect_df$N))
# Average final Number of failures
Simple_N_Fail <- mean(as.numeric(Simple_scenario_No_Effect_df$N_Fail))
Optimized_N_Fail <- mean(as.numeric(Optimized_scenario_No_Effect_df$N_Fail))
# output table
data.frame(Simple_scenario_No_Effect= c(Simple_N, Simple_N_Fail),
Optimized_scenario_No_Effect= c(Optimized_N, Optimized_N_Fail))
# Primary analysis results
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X")
Optimized_DrugX_sup_Placebo <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Placebo")
Optimized_Placebo_sup_DrugX <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Placebo")
# Proportion that deemed Drug X futile compared to Placebo
Simple_DrugX_Futility     <- NA
Optimized_DrugX_Futility  <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Futility")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y")
Optimized_DrugY_sup_Placebo <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Placebo")
Optimized_Placebo_sup_DrugY <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Placebo")
# Proportion that deemed Drug X futile compared to Placebo
Simple_DrugY_Futility     <- NA
Optimized_DrugY_Futility  <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Futility")
# (Co-primary) Drug X vs Drug Y
# Proportion of trials where both Drug X and Drug Y were significantly better than placebo
mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X"
& as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025 & Simple_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y")
mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" & Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y")
# Proportion of where Drug X significantly better than Drug Y
Simple_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025 &
Simple_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" &
as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025 &
Simple_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Simple_scenario_No_Effect_df$chisq1.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq1.XY_Result=="Superiority: Drug X")
Optimized_DrugX_sup_DrugY <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" &
Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Optimized_scenario_No_Effect_df$chisq1.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq1.XY_Result=="Superiority: Drug X")
# Proportion of where Drug Y significantly better than Drug X
Simple_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025 &
Simple_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" &
as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025 &
Simple_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Simple_scenario_No_Effect_df$chisq1.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq1.XY_Result=="Superiority: Drug Y")
Optimized_DrugY_sup_DrugX <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" &
Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" &
as.numeric(Optimized_scenario_No_Effect_df$chisq1.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq1.XY_Result=="Superiority: Drug Y")
# output table
data.frame(Simple_scenario_No_Effect= c(Simple_DrugX_sup_Placebo,
Simple_Placebo_sup_DrugX,
Simple_DrugX_Futility,
Simple_DrugY_sup_Placebo,
Simple_Placebo_sup_DrugY,
Simple_DrugY_Futility,
Simple_DrugX_sup_DrugY,
Simple_DrugY_sup_DrugX),
Optimized_scenario_No_Effect= c(Optimized_DrugX_sup_Placebo,
Optimized_Placebo_sup_DrugX,
Optimized_DrugX_Futility,
Optimized_DrugY_sup_Placebo,
Optimized_Placebo_sup_DrugY,
Optimized_DrugY_Futility,
Optimized_DrugX_sup_DrugY,
Optimized_DrugY_sup_DrugX))
# Secondary analysis
# Type A
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeA_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.PX_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.PX_Result=="Superiority: Drug X")
Optimized_TypeA_DrugX_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.PX_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.PX_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.PX_Result=="Superiority: Placebo")
Optimized_TypeA_Placebo_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.PX_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.PX_Result=="Superiority: Placebo")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug Y
Simple_TypeA_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.PY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.PY_Result=="Superiority: Drug Y")
Optimized_TypeA_DrugY_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.PY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.PY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.PY_Result=="Superiority: Placebo")
Optimized_TypeA_Placebo_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.PY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.PY_Result=="Superiority: Placebo")
# Drug X vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeA_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.XY_Result=="Superiority: Drug X")
Optimized_TypeA_DrugX_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.XY_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeA_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.A.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.A.XY_Result=="Superiority: Drug Y")
Optimized_TypeA_DrugY_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.A.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.A.XY_Result=="Superiority: Drug Y")
# Type B
# Placebo vs Drug X
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeB_DrugX_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.PX_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.PX_Result=="Superiority: Drug X")
Optimized_TypeB_DrugX_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.PX_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.PX_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_Placebo_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.PX_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.PX_Result=="Superiority: Placebo")
Optimized_TypeB_Placebo_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.PX_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.PX_Result=="Superiority: Placebo")
# Placebo vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug Y
Simple_TypeB_DrugY_sup_Placebo <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.PY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.PY_Result=="Superiority: Drug Y")
Optimized_TypeB_DrugY_sup_Placebo <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.PY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.PY_Result=="Superiority: Drug Y")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_Placebo_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.PY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.PY_Result=="Superiority: Placebo")
Optimized_TypeB_Placebo_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.PY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.PY_Result=="Superiority: Placebo")
# Drug X vs Drug Y
# Proportion that rejected the null hypothesis in favour of Drug X
Simple_TypeB_DrugX_sup_DrugY <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.XY_Result=="Superiority: Drug X")
Optimized_TypeB_DrugX_sup_DrugY <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.XY_Result=="Superiority: Drug X")
# Proportion that rejected the null hypothesis in favour of Placebo
Simple_TypeB_DrugY_sup_DrugX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq2.B.XY_p.value) < 0.05 &
Simple_scenario_No_Effect_df$chisq2.B.XY_Result=="Superiority: Drug Y")
Optimized_TypeB_DrugY_sup_DrugX <- 100*mean(as.numeric(Optimized_scenario_No_Effect_df$chisq2.B.XY_p.value) < 0.05 &
Optimized_scenario_No_Effect_df$chisq2.B.XY_Result=="Superiority: Drug Y")
# output table
data.frame(Simple_scenario_No_Effect= c(Simple_TypeA_DrugX_sup_Placebo,
Simple_TypeA_Placebo_sup_DrugX,
Simple_TypeA_DrugY_sup_Placebo,
Simple_TypeA_Placebo_sup_DrugY,
Simple_TypeA_DrugX_sup_DrugY,
Simple_TypeA_DrugY_sup_DrugX,
Simple_TypeB_DrugX_sup_Placebo,
Simple_TypeB_Placebo_sup_DrugX,
Simple_TypeB_DrugY_sup_Placebo,
Simple_TypeB_Placebo_sup_DrugY,
Simple_TypeB_DrugX_sup_DrugY,
Simple_TypeB_DrugY_sup_DrugX),
Optimized_scenario_No_Effect= c(Optimized_TypeA_DrugX_sup_Placebo,
Optimized_TypeA_Placebo_sup_DrugX,
Optimized_TypeA_DrugY_sup_Placebo,
Optimized_TypeA_Placebo_sup_DrugY,
Optimized_TypeA_DrugX_sup_DrugY,
Optimized_TypeA_DrugY_sup_DrugX,
Optimized_TypeB_DrugX_sup_Placebo,
Optimized_TypeB_Placebo_sup_DrugX,
Optimized_TypeB_DrugY_sup_Placebo,
Optimized_TypeB_Placebo_sup_DrugY,
Optimized_TypeB_DrugX_sup_DrugY,
Optimized_TypeB_DrugY_sup_DrugX))
0.8*1000+0.9*1000
8+9
17/1000
100*mean(as.numeric(Simple_scenario_df$chisq1.PX_p.value) < 0.025)
Optimized_power <- 100*mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X" | Optimized_scenario_df$chisq1.PX_Result=="Superiority: Placebo")
Optimized_power
# Power: Drug Y vs Placebo
Simple_power_PY <- 100*mean(as.numeric(Simple_scenario_df$chisq1.PY_p.value) < 0.025)
Optimized_power_PY <- 100*mean(Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y" | Optimized_scenario_df$chisq1.PY_Result=="Superiority: Placebo")
Optimized_power_PY
Simple_power_PY
# Power: Drug X vs Placebo
Simple_typeIerror_PX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025)
Simple_typeIerror_PX
# Strength of method measures
# Average final trial size
Simple_N <- mean(as.numeric(Simple_scenario_df$N))
Optimized_N <- mean(as.numeric(Optimized_scenario_df$N))
# Average final Number of failures
Simple_N_Fail <- mean(as.numeric(Simple_scenario_df$N_Fail))
Optimized_N_Fail <- mean(as.numeric(Optimized_scenario_df$N_Fail))
# Power: Drug X vs Placebo
Simple_power_PX <- mean(as.numeric(Simple_scenario_df$chisq1.PX_p.value) < 0.025)
Optimized_power_PX <- mean(Optimized_scenario_df$chisq1.PX_Result=="Superiority: Drug X" | Optimized_scenario_df$chisq1.PX_Result=="Superiority: Placebo")
# Power: Drug Y vs Placebo
Simple_power_PY <- mean(as.numeric(Simple_scenario_df$chisq1.PY_p.value) < 0.025)
Optimized_power_PY <- mean(Optimized_scenario_df$chisq1.PY_Result=="Superiority: Drug Y" | Optimized_scenario_df$chisq1.PY_Result=="Superiority: Placebo")
# output table
data.frame(Simple_scenario= c(Simple_N, Simple_N_Fail),
Optimized_scenario= c(Optimized_N, Optimized_N_Fail),
power_PX= c(Simple_power_PX, Optimized_power_PX),
power_PY= c(Simple_power_PY, Optimized_power_PY)
)
data.frame(Simple_scenario= c(Simple_N, Simple_N_Fail, Simple_power_PX, Simple_power_PY),
Optimized_scenario= c(Optimized_N, Optimized_N_Fail, Optimized_power_PX, Optimized_power_PY))
# Type I error: Drug X vs Placebo
Simple_typeIerror_PX <- 100*mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025)
Simple_typeIerror_PX
Optimized_power_PX <- 100*mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" | Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Placebo")
Optimized_power_PX
Simple_typeIerror_PX <- mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025)
Optimized_power_PX <- mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" | Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Placebo")
# Type I error: Drug Y vs Placebo
Simple_power_PY <- mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025)
Optimized_power_PY <- mean(Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" | Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Placebo")
Simple_typeIerror_PX <- mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PX_p.value) < 0.025)
Optimized_typeIerror_PX <- mean(Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Drug X" | Optimized_scenario_No_Effect_df$chisq1.PX_Result=="Superiority: Placebo")
# Type I error: Drug Y vs Placebo
Simple_typeIerror_PY <- mean(as.numeric(Simple_scenario_No_Effect_df$chisq1.PY_p.value) < 0.025)
Optimized_typeIerror_PY <- mean(Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Drug Y" | Optimized_scenario_No_Effect_df$chisq1.PY_Result=="Superiority: Placebo")
# output table
data.frame(Simple_scenario_No_Effect= c(Simple_N, Simple_N_Fail, Simple_typeIerror_PX, Simple_typeIerror_PY),
Optimized_scenario_No_Effect= c(Optimized_N, Optimized_N_Fail, Optimized_typeIerror_PX, Optimized_typeIerror_PY))
7.1+9
print( getwd() )
sys.frame(sys.nframes())$ofile
setwd(getSrcDirectory(function(){})[1])
print(utils::getSrcFilename(function(){}, full.names = TRUE))
print(utils::getSrcDirectory(function(){}))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
dirname(rstudioapi::getActiveDocumentContext()$path)
setwd("~/GitHub/Calibration-Review")
list.files()
raw_data <- read.csv("review_396964_20240504214514.csv")
raw_data
raw_data
nrow(raw_data)
# Any differences between Title output by covidence vs reviewers ?
which(raw_data$Title != raw_data$Full.title)
raw_data |>
filter(Title != Full.title)
raw_data |>
filter(Title != Full.title)|>
pull(Title, Full.title)
raw_data |>
filter(Title != Full.title)|>
select(Title, Full.title)
raw_data
# Explore country names
table(raw_data$Study.setting)
# Explore country names
raw_data |>
group_by(Study.setting) |>
summary(N=n())|>
arrange(N)
raw_data |>
group_by(Study.setting) |>
summary(N=n())
# Explore country names
raw_data |>
group_by(Study.setting) |>
summarise(N=n())|>
arrange(N)
# Explore country names
raw_data |>
group_by(Study.setting) |>
summarise(N=n())|>
arrange(-N)
list_countries(nomenclature = "name_en")
install.packages("countries")
library(countries)
list_countries(nomenclature = "name_en")
list_countries <- list_countries(nomenclature = "name_en")
raw_data |>
filter(!Study.setting %in% list_countries)
raw_data |>
filter(! Study.setting %in% list_countries) |>
pull(Study.setting)
