---
title: "Objective 3 - Figures"
output: html_document
date: "2024-09-06"
---

```{r}
# load libraries
library(xlsx)
library(cartography)

# load data
setwd("~/GitHub/Calibration-Review/2.Analysis")
Table3 <- read.xlsx("Table3.xlsx", sheetName ="Table 3")

## Histogram 
Table3 |>
  ggplot() +
  geom_histogram(aes(x=as.numeric(Sum_Reporting_Score), fill=Reporting_comprehensiveness))+
  theme_classic()+
  xlab("Reporting Score")+
  scale_fill_manual(name = "Reporting comprehensiveness", values = carto.pal(pal1 = "pastel.pal" ,n1 = 10)[c(10,6,8)]) + 
  scale_x_continuous(breaks=c(1:15), limits = c(1,14))
  
# Basic piechart
Table3 |>
  filter(Reporting_comprehensiveness != "")|>
  group_by(Reporting_comprehensiveness)|>
  summarise(value= n())|>
ggplot(aes(x="", y=value, fill=Reporting_comprehensiveness)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  theme_void() +
  scale_fill_manual(name = "Reporting comprehensiveness", values = carto.pal(pal1 = "pastel.pal" ,n1 = 10)[c(10,6,8)])+
  geom_text(aes(y = c(360,150,3), x=c(1, 1, 1.3), label = value), color = "white", size=5) 
```

